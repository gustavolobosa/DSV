@model verificable.Models.Formulario

@{
    ViewData["Title"] = "Create";
}

<h1>Create</h1>

<h4>Formulario</h4>
<hr />
<div class="row">
    <div class="col-md-4">

        <form asp-action="Create" method="post">

            <label for="cne">CNE:</label>
            <select name="Cne" class="form-control">
                <option asp-for="Cne" value="Compraventa">Compraventa</option>
                <option asp-for="Cne" value="Regualrizacion De Patrimonio">Regularizacion de Patrimonio</option>
            </select>

            <label for="comuna">Comuna:</label>
            <input type="text" id="comuna" name="comuna"><br>

            <label for="manzana">Manzana:</label>
            <input type="text" id="manzana" name="manzana"><br>

            <label for="predio">Predio:</label>
            <input type="text" id="predio" name="predio"><br>

            <label for="fojas">Fojas:</label>
            <input type="number" id="fojas" name="fojas"><br>

            <label for="fecha_inscripcion">Fecha de Inscripción:</label>
            <input type="date" id="fecha_inscripcion" name="fecha_inscripcion"><br>

            <label for="num_inscripcion">Número de Inscripción:</label>
            <input type="number" id="num_inscripcion" name="num_inscripcion"><br>

            <h4>Enajenantes:</h4><br><br>

            <table id="enajenantes">
                <thead>
                    <tr>
                        <th>Run/Rut</th>
                        <th>Porcentaje de derecho</th>
                        <th>No acreditado</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <input type="text" name="enajenantes[0].run_rut" />
                        </td>
                        <td>
                            <input type="number" step="0.01" name="enajenantes[0].porcentaje_derecho" />
                        </td>
                        <td>
                            <input type="number" step="0.01" name="enajenantes[0].no_acreditado" />
                        </td>
                        <td>
                            <button type="button" class="btn btn-danger" onclick="removeEnajenantes(this)">Remove</button>
                        </td>
                    </tr>
                </tbody>
            </table>

            <button type="button" class="btn btn-primary" onclick="addEnajenantes()">Add Enajenantes</button><br><br>

            <h4>Adquirientes:</h4><br><br>

            <table id="adquirientes">
                <thead>
                    <tr>
                        <th>Run/Rut</th>
                        <th>Porcentaje de derecho</th>
                        <th>No acreditado</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <input type="text" name="adquirentes[0].run_rut" />
                        </td>
                        <td>
                            <input type="number" step="0.01" name="adquirentes[0].porcentaje_derecho" />
                        </td>
                        <td>
                            <input type="number" step="0.01" name="adquirentes[0].no_acreditado" />
                        </td>
                        <td>
                            <button type="button" class="btn btn-danger" onclick="removeAdquirente(this)">Remove</button>
                        </td>
                    </tr>
                </tbody>
            </table>

            <button type="button" class="btn btn-primary" onclick="addAdquirente()">Add Adquirente</button><br><br>


            <input type="submit" value="Enviar">
        </form>

    </div>
</div>

<div>
    <a asp-action="Index">Back to List</a>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

    <script>

        //Para  enajenantes

        var enajenantesCount = 1;

        function addEnajenantes() {
            var enajenantesTable = document.getElementById("enajenantes").getElementsByTagName('tbody')[0];
            var newRow = enajenantesTable.insertRow(-1);

            var runRutCell = newRow.insertCell(0);
            runRutCell.innerHTML = '<input type="text" name="enajenantes[' + enajenantesCount + '].run_rut" />';

            var porcentajeCell = newRow.insertCell(1);
            porcentajeCell.innerHTML = '<input type="number" step="0.01" name="enajenantes[' + enajenantesCount + '].porcentaje_derecho" />';

            var noAcreditadoCell = newRow.insertCell(2);
            noAcreditadoCell.innerHTML = '<input type="number" step="0.01" name="enajenantes[' + enajenantesCount + '].no_acreditado" />';

            var removeCell = newRow.insertCell(3);
            removeCell.innerHTML = '<button type="button" class="btn btn-danger" onclick="removeEnajenantes(this)">Remove</button>';

            enajenantesCount++;
        }

        function removeEnajenantes(button) {
            var row = button.parentNode.parentNode;
            row.parentNode.removeChild(row);
        }

        //Para adquirientes

        var adqCount = 1;

        function addAdquirente() {
            var adqTable = document.getElementById("adquirientes").getElementsByTagName('tbody')[0];
            newRow = adqTable.insertRow(-1);

            runRutCell = newRow.insertCell(0);
            runRutCell.innerHTML = '<input type="text" name="adquirentes[' + adqCount + '].run_rut" />';

            porcentajeCell = newRow.insertCell(1);
            porcentajeCell.innerHTML = '<input type="number" step="0.01" name="adquirentes[' + adqCount + '].porcentaje_derecho" />';

            noAcreditadoCell = newRow.insertCell(2);
            noAcreditadoCell.innerHTML = '<input type="number" step="0.01" name="adquirentes[' + adqCount + '].no_acreditado" />';

            removeCell = newRow.insertCell(3);
            removeCell.innerHTML = '<button type="button" class="btn btn-danger" onclick="removeAdquirente(this)">Remove</button>';

            adqCount++;
        }

        function removeAdquirente(button) {
            row = button.parentNode.parentNode;
            row.parentNode.removeChild(row);
        }
    </script>
}
